# Sprint 0-1: Grundläggning (November 2025)

> Konsoliderad sammanfattning av 2 retrospectives från Sprint 0 (2025-11-19) och Sprint 1 (2025-11-21).

## Sammanfattning

| Session | Datum | Ämne | Resultat |
|---------|-------|------|----------|
| Sprint 0 | 2025-11-19 | DDD foundation, TDD setup, Repository pattern | 150 tester, 100% coverage. 6 regressions identifierade |
| Sprint 1 | 2025-11-21 | Repository pattern scaled, behavior-based testing | 343 tester, 100% coverage. 4.5/5 features klara (90%) |

## Viktiga Learnings

### 1. Behavior-Based Testing är Obligatoriskt

Byte från implementation-based till behavior-based testing var game-changer. Tester överlevde `include` → `select` refactoring utan ändringar, minskade test maintenance med ~70%.

**Pattern:**
- ✅ Test API contract (status code, response shape, security assertions)
- ❌ Undvik mock assertions på implementation details (Prisma syntax, argument structure)

### 2. Environment Setup är Kritiskt

Sprint 1 avslöjade att `.env` och seed data inte var dokumenterade. E2E tests failade lokalt och i CI. Lösning implementerad:
- `.env.example` med alla required vars
- `import 'dotenv/config'` i setup scripts
- Dokumenterad seed-strategi i README

**Learning:** "90% done" är inte done — verifiera alltid i target environment.

### 3. Repository Pattern Overhead är Värt Det

Provider + Service repositories etablerade mönstret korrekt. Konsistens viktigare än minimal overhead, särskilt då Service-domänen blir komplex (pricing, availability, packages).

## Nyckelmetrik

- **Unit tests**: Sprint 0 → 150, Sprint 1 → 343 (100% passing)
- **E2E tests**: Local setup etablerad, CI-integration 90% klar
- **Repository pattern**: BookingRepository, ProviderRepository, ServiceRepository
- **API test migration**: 100% behavior-based
- **Sprint completion**: Sprint 0 (100%), Sprint 1 (90%)

## Konkreta Problem Lösta

1. **Test regressions** (Sprint 0 → 1): Pre-merge gate var svag (körde bara nya filer). Löst med full suite-körning.
2. **E2E CI integration** (Sprint 1): Saknad `DATABASE_URL` i GitHub Actions. Löst genom env-var setup.
3. **Seed data management** (Sprint 1): Ad-hoc seed. Löst genom deterministic seed i test workflow.
4. **Pre-merge gate** (Sprint 1): Manuell checklist. Löst genom GitHub branch protection + automated workflow.

## Process Improvements Implementerade

- **DoD Update:** Environment variables måste dokumenteras i `.env.example`
- **Mid-Sprint Check-in:** 15-min sync för sprints >1 vecka för blocker-detection
- **Proaktiv Agent Usage:** Security-reviewer för payment-related, data-architect för komplex schema

---

*Originaldokument: [docs/archive/retrospectives-raw/sprint-0-1-retro.md](../archive/retrospectives-raw/sprint-0-1-retro.md)*

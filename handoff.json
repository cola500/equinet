{
  "project": "equinet",
  "plan": "Kognitiv last-reduktion för kunder och leverantörer",
  "branch": "feature/cognitive-load-reduction",
  "created": "2026-02-27",
  "status": "Sprint 1 KLAR (committad). Sprint 2 NÄSTA. Sprint 3-4 kvar.",

  "completed": {
    "sprint_1": {
      "name": "Quick Wins",
      "status": "DONE",
      "commit": "1146065 feat: reduce cognitive load - Sprint 1 quick wins",
      "tasks": [
        { "id": "1.1", "name": "Gruppera Mer-menyn med sektioner", "files": ["src/components/layout/ProviderNav.tsx", "src/components/layout/BottomTabBar.tsx"] },
        { "id": "1.2", "name": "Synlig rensa-filter + scrollbara chips", "files": ["src/app/providers/page.tsx"] },
        { "id": "1.3", "name": "Kalenderlegend bakom popover", "files": ["src/app/provider/calendar/page.tsx"] },
        { "id": "1.4", "name": "Intervall -> Besöksschema", "files": ["src/app/customer/horses/[id]/page.tsx"] }
      ]
    }
  },

  "next_sprint": {
    "sprint_2": {
      "name": "Dashboard-fokus",
      "status": "READY TO IMPLEMENT",
      "instruction": "Kör /implement med denna fil som plan. Branch: feature/cognitive-load-reduction (redan utcheckad).",
      "tasks": [
        {
          "id": "2.1",
          "name": "Dashboard progressive disclosure för statistik",
          "files": ["src/app/provider/dashboard/page.tsx"],
          "detailed_steps": [
            "1. Lägg till useState<boolean|null>(null) showCharts. useEffect: om bookings.length >= 10 -> true, annars false. Kör bara en gång (null-check).",
            "2. Wrappa DashboardCharts (rad 247-253) i en collapsible: button 'Visa statistik' / 'Dölj statistik' med ChevronDown-icon + animation.",
            "3. Ta bort 'Dina tjänster'-sektionen helt (rad 373-418). Den duplicerar /provider/services.",
            "4. Minska quick-actions (rad 316-371): Behåll Se bokningar (badge), Kalender, Kundregister + 1 dynamisk (voice log ELLER ruttplanering, inte båda). Ta bort 'Hantera tjänster' (nåbar via nav).",
            "5. Ta bort Wrench från lucide-react import (rad 19). Lägg till ChevronDown."
          ],
          "test_strategy": "UI-only, verifieras med typecheck"
        },
        {
          "id": "2.2",
          "name": "PriorityActionCard -- 'Vad ska jag göra nu?'",
          "files": [
            "src/components/provider/PriorityActionCard.tsx (NY FIL)",
            "src/app/provider/dashboard/page.tsx"
          ],
          "detailed_steps": [
            "1. Skapa PriorityActionCard.tsx med props: { pendingCount: number, routes: Route[], onboardingComplete: boolean }",
            "2. Prioritetslogik (visa FÖRSTA matchande):",
            "   a) pendingCount > 0 -> gul Card: 'Du har {N} nya förfrågningar' + Link till /provider/bookings",
            "   b) routes har rutt idag -> grön Card: 'Du har en rutt idag' + Link till /provider/routes/{id}. Använd isToday() från date-fns.",
            "   c) routes har rutt imorgon -> blå Card: 'Du har en rutt imorgon' + Link till /provider/routes/{id}. Använd isTomorrow() från date-fns.",
            "   d) !onboardingComplete -> Card med CTA 'Slutför din profil'. Länka till /provider/profile.",
            "   e) Inget matchar -> returnera null (visa inget kort)",
            "3. I dashboard/page.tsx: Hämta onboarding-status (fetch /api/provider/onboarding-status). Rendera PriorityActionCard OVANFÖR OnboardingChecklist.",
            "4. Route-typ: { id: string, routeName: string, routeDate: string, startTime: string, status: string, stops?: Array<{status: string}> }"
          ],
          "test_strategy": "TDD för prioritetslogiken. Extrahera getPriorityAction(pendingCount, routes, onboardingComplete) som en ren funktion och skriv unit-tester.",
          "data_sources": {
            "pending_bookings": "Redan tillgängligt som pendingCount i dashboard",
            "routes": "Redan tillgängligt som routes[] i dashboard (från /api/routes/my-routes). Har routeDate (ISO string), status, stops[].",
            "onboarding": "Fetcha /api/provider/onboarding-status. Returnerar { allComplete: boolean, profileComplete, hasServices, hasAvailability, isActive }."
          }
        },
        {
          "id": "2.3",
          "name": "Konsekvent destruktiv-action-bekräftelse",
          "files_to_migrate": {
            "from_AlertDialog_to_ResponsiveAlertDialog": [
              {
                "file": "src/components/calendar/BookingDetailDialog.tsx",
                "what": "Avboka-bekräftelse (showCancelDialog state, rad ~439-473). Byt AlertDialog* -> ResponsiveAlertDialog*.",
                "imports_to_change": "AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle -> ResponsiveAlertDialog-varianter från @/components/ui/responsive-alert-dialog"
              },
              {
                "file": "src/app/provider/bookings/page.tsx",
                "what": "Avboka-bekräftelse (bookingToCancel state). Byt AlertDialog* -> ResponsiveAlertDialog*."
              },
              {
                "file": "src/app/provider/announcements/page.tsx",
                "what": "Avbryt rutt-annons. Byt AlertDialog* -> ResponsiveAlertDialog*."
              }
            ],
            "reference_implementation": "src/components/provider/customers/DeleteConfirmDialogs.tsx -- detta är mönstret att följa. Använder ResponsiveAlertDialog med röda action-buttons."
          },
          "test_strategy": "UI-only, verifieras med typecheck. Ingen logik ändras -- bara dialog-komponent byts.",
          "already_correct": [
            "DeleteConfirmDialogs.tsx (kunder) -- redan ResponsiveAlertDialog",
            "customer/bookings/page.tsx -- redan ResponsiveAlertDialog",
            "customer/horses/page.tsx -- redan ResponsiveAlertDialog",
            "customer/group-bookings/[id]/page.tsx -- redan ResponsiveAlertDialog"
          ]
        }
      ]
    }
  },

  "remaining_after_sprint_2": {
    "sprint_3": {
      "name": "Flödesförenkling",
      "status": "NOT STARTED",
      "tasks": [
        { "id": "3.1", "name": "Gruppbokning: dela formuläret i 2 steg", "files": ["src/app/customer/group-bookings/new/page.tsx"] },
        { "id": "3.2", "name": "Bokningsflöde: auto-välj häst om kunden har 1", "files": ["src/hooks/useBookingFlow.ts", "MobileBookingFlow.tsx", "DesktopBookingDialog.tsx", "BookingSummaryCard.tsx"] },
        { "id": "3.3", "name": "Kundsida hook-extrahering + förenad dialog", "files": ["src/hooks/useCustomerPage.ts (NY)", "customers/page.tsx", "AddCustomerDialog.tsx"] }
      ]
    },
    "sprint_4": {
      "name": "Infrastruktur + polish",
      "status": "NOT STARTED",
      "tasks": [
        { "id": "4.1", "name": "Standardisera laddningstillstånd med skeletons", "files": ["~4 nya skeleton-filer", "~15 page.tsx"] },
        { "id": "4.2", "name": "FirstUseTooltip för kontextuell hjälp", "files": ["first-use-tooltip.tsx (NY)", "5 page.tsx-filer"] }
      ]
    }
  },

  "quality_gates": {
    "typecheck": "npm run typecheck -- 0 errors",
    "lint": "npm run lint -- 0 errors",
    "tests": "npm run test:run -- alla gröna",
    "swedish": "npm run check:swedish"
  },

  "notes": [
    "Sprint 2.2 har testbar logik (getPriorityAction) -- TDD rekommenderas",
    "Sprint 2.1 + 2.3 är ren UI -- typecheck räcker",
    "date-fns redan i kodbasen: isToday(), isTomorrow() tillgängliga",
    "ResponsiveAlertDialog finns i src/components/ui/responsive-alert-dialog.tsx",
    "OnboardingChecklist hämtar från /api/provider/onboarding-status, returnerar { allComplete: boolean }",
    "Pre-existing lint warnings (7 st, alla i e2e/) -- inte från våra ändringar"
  ]
}
